@import 'variables';
@import 'typography';
@import 'toggles';

body {
  color: $foreground;
  display: flex;
  flex-direction: row-reverse;
  flex-wrap: wrap;
  width: 100%;
  justify-content: flex-center;
  // max-width: 700px;
  margin: 0 auto;
  @include vr($padding: 2);

  animation: 1s cubic-bezier(0.000, 1.010, 0.025, 0.995) 0s 1 slideDown;

  .fix-wrap {
    flex-grow: 1;
  }

  > * {
    position: relative;
    z-index: 1;
    transition: .2s color, .5s background-color;
  }

  > label, > input[type='checked'] {
    @include vr($margin: 0.5);
    font-size: .7em;
  }

  main {
    max-width: 40em;
    margin: 0 auto;
  }

  content {
    background: radial-gradient(
      150px 40px at 195px bottom,
      var(color(foreground)),
      rgba(0,0,0,0)
    );
    margin: 0 auto;
    display: flex;
    flex-basis: 100%;
    width: 100%;
    flex-direction: column;
    z-index: 1;
    position: relative;
    @include vr($padding: 2 0 0 0);
    
	*:not(hr):not(main) {
	  max-width: 100%;
      z-index: 1;
	}

    &::after {
      content: "";
      display: block;
      background: linear-gradient(
      to right,
      $color0 50px,
      $foreground 195px,
      $color0 350px
      );
      height: 1px;
      position: absolute;
      bottom: 0;
      width: 100%;
      left: 0;
    }
  }
  .amp {
    font-family: Baskerville, 'Goudy Old Style', Palatino, 'Book Antiqua', serif;
    font-style: italic;
    font-weight: normal;
  }
  bg{
    content: '';
    position: fixed;
    z-index: 0;
    top: 0; bottom: 0; left: 0; right: 0;
    background: radial-gradient(
    circle closest-corner at center 125px,
    $background,
    $color0 40%
    ) no-repeat !important;
  }
}

ul {
  padding: 0;
  margin-top: 0;
  list-style: none;
  > li {
    color: $foreground;
    position: relative;
    &:before {
      color: color(green-light);
      content: 	'•';
      position: absolute;
      left: 0;
      @include vr($margin-left: -1);
    }
  }
}

input[name='switch-mode']:checked {
  & ~ bg {
    background: color(foreground) !important;
  }
  & ~ content{
    &, ul > li {
      color: color(background);
    }
    li:before {
      color: color(yellow-dark)
    }
    h5, h6 {
      color: color(blue-light-4);
    }
  }
}

h1 {
  text-align: center;
  margin-bottom: 0;
}

h1 + p {
  &, & + p, & + p + p { 
    text-align: center;
    a {
      display: inline-block;
      + br {
        display: none;
      }
      &:before, &:after {
        content: '[';
        display: inline-block;
        opacity: 0;
        transition: transform 0.3s, opacity 0.2s;
        @include vr($margin-right: .5);
        content: '[';
        transform: translateX(20px);
        color: color(foreground);
      }
      &:hover {
        &:before, &:after {
          opacity: 1;
          transform: translateX(0);
        }
      } 
      &:after {
        content: ']';
        transform: translateX(-20px);
        @include vr($margin-left: .5);
      }
    }
  }

  @keyframes shake {
    10%, 90% {
      transform: translate3d(-1px, 0, 0);
    }

    20%, 80% {
      transform: translate3d(2px, 0, 0);
    }

    30%, 50%, 70% {
      transform: translate3d(-4px, 0, 0);
    }

    40%, 60% {
      transform: translate3d(4px, 0, 0);
    }
  }

  .shake {
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
    perspective: 1000px;
    &:hover,
    &:focus,
    &:active {
      animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;
      transform: translate3d(0, 0, 0);
      backface-visibility: hidden;
      perspective: 1000px;
    }
  }


  img {
    @include vr($height: 4);
    @extend .shake;
  }
}

@keyframes slideDown {
  0% {
    transform: translate3d(0, -2rem, 0);
    opacity: 0;
  }
  80% {
    transform: translate3d(0, -0.0rem, 0);
  }
  100% {
    transform: translate3d(0, 0, 0);
    opacity: 1;
  }
}

content {
  color: color(foreground);
  @include vr($margin-top: -1);
}

h1, h2, h3, h4 {
  color: color(green-dark);

}

h5, h6 {
  color: color(yellow-dark);
  margin-bottom: 0;
  text-transform: uppercase;
}

a {
  color: color(maroon);
}

ul.menu {
  list-style: none;
  display: flex;
  position: absolute;
  top: 0;
  right: 5rem;
  li {
    transform: skewx(-15deg);
    a {
      display: inline-block;
      transform: skewx(15deg);
    }
  }
}

$lines: 16;

#likes + ul {
  padding: 0;
  margin-top: 0;
  width: 50rem;
  @include vr($height: 1);
  overflow: hidden;
  position: relative;

  > * {
    line-height: 2rem;
  }

  &::after {
    display: block;
    content: "Vik ♥️";
    position: absolute;
    top: 0;
    width: 2em; // em used as we're monospaced :)
    @include vr($line-height: 1);
    white-space: nowrap;
  }

  li {
    &:before {
      display: none;
    }
    margin-left: 3.5em; // em used as we're monospaced :)
    list-style: none;
    animation: ticker $lines+s cubic-bezier(1, 0, 0.5, 0) infinite;
    color: $color2;
    @include vr($line-height: 1);
  }
}

a {
  color: color(blue-light);
  font-size: .8em;
  text-decoration: underline; 
  text-decoration-skip-ink: auto;
  background-repeat: repeat-x;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none slice' width='1' height='1'><rect width='100%' height='100%' style='fill:#FFF' /></svg");
  background-position: 0 1.06em;
  background-size: 100% 100%;
  &:hover {
    text-decoration: none;
  }
}

@keyframes ticker {
  @for $i from 0 through $lines {
    #{$i * 95 / $lines * 1%} {
      transform: translate3d(0, 100*$i*-1%, 0);
    }
  }
  100% {
    transform: translate3d(0, 0%, 0);
  }
}

footer {
  flex-basis: 100%;
  font-size: 75%;
}

//////// ORDERING ///////
@mixin order($order) {
  &, ~ *{
    order: $order;
  }
}

$sections-list:
#vik-ramanujam,
#skills-and-interests,
#work-experience,
#education,
#interests,
#credits;

@each $section in $sections-list {
  $i: index($sections-list, $section);
  #{$section}{
    @include order($i);
  }
}

#vik-ramanujam + p {
  order: 0;
}

#likes {
  @include order(1);
}

#likes ~ hr, #credits { // before copyright
  @include order(10);
  + p {
    font-size: .8em;
    margin-bottom: 0;
  }
}


/////// CLEAN UP /////////
#likes, #skills-and-interests, #contact {
  // avoid display: none - accesibility
  height: 0;
  overflow: hidden;
}

#contact + p {
  margin-bottom: 0;
}

content hr:last-of-type {
  display: none; // hide stackedit meta
}
